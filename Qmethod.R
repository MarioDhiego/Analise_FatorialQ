#===============================================================================#
#==== DESCRIÇÃO:      Análise Fatorial Q
#==== ESCRITO POR:    Mário Diego
#==== DOUTORADO/UFRA: Ana Paula
#===============================================================================#

#===============================================================================
# 1.0 Leitura de Pacotes -------------------------------------------------------
library(qmethod)
library(psych)
library(dplyr)
library(readr)
library(readxl)
library(ggplot2)
#===============================================================================

#===============================================================================
# 1.1 Definir Diretório --------------------------------------------------------
setwd("C:/Users/mario Dhiego/Documents/Analise_FatorialQ")
#===============================================================================

#===============================================================================
# 1.2 Leitura de dados ---------------------------------------------------------

qsort1 <- c(4,3,3,4,3,3,3,4,-1,3,4,3,2,-3,3,3,4,4,2,4,4,3,3,2,4,3,3,4,4,1,3,4,1,-4,2,4,4,4,-1,-1,3,-2)
################################################################################
qsort2 <- c(-3,4,4,4,4,4,4,4,4,4,4,4,4,-4,-3,4,-3,4,4,3,4,4,3,4,4,3,4,4,-3,-3,3,4,4,-4,-3,4,4,4,-3,3,4,-4)
################################################################################
qsort3 <- c(-4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,2,4,4,4,4,-2,2,4,-1,-4,4,4,4,2,4,4,4,-4)
################################################################################
qsort4 <- c(3,4,2,4,4,4,2,4,3,2,4,3,3,4,-4,-3,-4,-3,-3,-3,-4,-4,-4,-4,-4,-4,-3,-3,-3,-3,-4,-3,-3,-4,-3,-3,-4,-3,-4,-3,-4,-3)
################################################################################
qsort5 <- c(1,1,1,3,3,1,4,1,1,3,1,1,3,1,4,1,1,1,1,0,1,0,0,-1,1,1,3,4,3,3,3,1,3,0,4,4,4,4,4,1,4,-4)
################################################################################
qsort6 <- c(3,3,2,1,1,4,2,4,3,2,3,2,4,-4,1,4,4,3,2,1,3,2,4,3,4,3,2,3,4,4,4,3,1,-4,1,2,4,3,2,2,3,-3)
################################################################################
qsort7 <- c(2,4,-4,3,4,0,4,2,-3,4,4,4,4,-4,4,4,2,4,3,4,4,4,4,4,2,4,-3,4,4,2,4,1,-4,4,4,3,0,-1,3,-1,4,0)
################################################################################
qsort8 <- c(2,1,1,0,-1,1,2,1,1,3,3,1,3,-1,-1,4,0,1,3,1,2,0,2,1,0,2,2,0,1,0,2,1,0,2,1,-1,-2,4,0,3,1,0)
################################################################################
qsort9 <- c(-3,-1,1,1,1,2,3,3,4,2,4,4,3,3,3,1,4,4,4,-2,4,2,2,1,-1,4,1,2,1,-2,2,2,3,2,3,3,3,4,3,4,3,-2)
################################################################################
qsort10 <- c(-3,1,1,2,4,3,3,1,1,2,2,3,2,-4,-1,2,3,4,3,1,4,3,2,-1,3,-1,-1,-1,-1,-1,2,-1,4,3,-1,1,3,2,1,1,2,-2)
################################################################################
qsort11 <- c(2,3,3,3,2,3,4,4,-2,3,4,3,3,-2,3,3,4,4,3,3,4,2,4,4,3,3,3,3,3,3,3,3,0,3,3,3,3,2,2,3,4,1)
################################################################################
qsort12 <- c(-2,4,4,4,-1,-1,4,4,4,4,4,4,-4,2,-1,4,-2,4,4,4,4,-1,4,2,2,4,4,4,4,-2,4,-1,-1,4,-4,2,4,4,-2,-2,4,2)
################################################################################
qsort13 <- c(2,4,2,4,4,0,2,3,4,4,3,4,3,1,-2,3,4,3,3,3,-2,4,4,3,2,3,1,1,-2,2,3,3,1,1,1,0,4,4,4,1,2,-2)
################################################################################
qsort14 <- c(3,4,4,4,4,4,4,2,4,4,4,4,4,-4,4,4,4,4,4,4,3,2,4,3,4,4,4,4,3,2,4,2,4,-2,2,4,4,4,3,4,4,-4)
################################################################################
qsort15 <- c(1,4,3,4,2,4,4,-2,4,4,3,4,-4,1,-3,4,4,-2,4,-2,4,4,4,-2,4,-2,4,4,4,-2,4,-2,4,4,4,4,4,4,-3,4,4,4)
################################################################################
qsort16 <- c(4,4,4,4,4,4,4,4,4,4,4,-4,4,-4,4,-1,4,4,3,-4,4,-4,4,4,4,4,4,-2,-4,4,4,4,4,4,4,4,-1,4,4,-2,-2,4)
################################################################################
qsort17 <- c(4,-3,-3,3,2,4,4,4,4,4,44,4,1,4,4,-2,4,3,3,4,4,4,3,3,3,3,4,4,0,3,2,4,-4,4,0,3,4,4,4,1,-4)
################################################################################
qsort18 <- c(0,2,3,3,4,4,4,4,2,-3,4,1,-3,-1,4,4,4,4,2,4,3,1,4,-2,-1,4,4,4,-1,-4,4,-1,2,3,-2,4,2,3,3,1,-1,4)
################################################################################
qsort19 <- c(2,3,3,3,4,4,4,3,4,4,4,4,3,3,3,3,3,3,3,2,3,3,3,3,4,3,3,4,4,3,3,3,3,2,3,3,4,3,2,3,4,4)
################################################################################
qsort20 <- c(4,3,4,3,4,4,4,4,2,4,4,3,2,4,2,2,1,4,3,4,3,4,3,4,4,2,4,4,2,4,2,2,1,2,4,3,3,4,2,3,4,-4)
################################################################################
qsort21 <- c(3,4,3,4,3,4,3,2,1,4,4,2,3,4,3,2,1,4,1,2,3,3,2,2,1,2,2,3,2,2,3,2,3,4,3,4,1,3,2,1,2,3)
################################################################################
qsort22 <- c(2,4,3,4,4,4,4,2,3,2,4,3,4,4,-3,-3,4,4,4,4,4,3,4,4,-2,-3,-3,-3,4,-3, -3,-4,-3,-4,-3,4,4,4,-3,4,4,4)
################################################################################
qsort23 <- c(3, 3, 3, 1, 4, 4, 4, 3, 2, 2, 4, 4, 3, -4, -4, 4, 3, 4, 3, 4, 3, 4, 3, 4, 4, 4, 3, 3, 4, -4, 4, -1, -3, -3, -3, 4, 4, 4, 4, -3, 3, 3)
################################################################################
qsort24 <- c(2, 4, 3, 3, 4, 4, 4, 4, 3, 4, 4, 4, 4, 2, 4, 4, 3, 4, 4, 3, 4, 4, 4, 4, 3, 4, 3, 4, 4, 4, 4, 4, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4)
################################################################################
qsort25 <- c(1, -3, 4, 4, 0, 0, 4, -4, -2, -2, 2, 3, 4, 3, -3, -4, -3, -2, -2, -3, 3, 4, -3, -3, -4, 3, -3, 4, -3, -3, -3, -3, -3, -4, -4, -3, -4, -2, -3, -2, -3, 4)
################################################################################
qsort26 <- c(3, 4, -2, 4, 4, 4, 4, 4, -4, -3, 4, 4, 4, -3, 4, 4, 4, 4, 4, -4, 4, 4, 3, 4, -4, -3, 4, 3, 4, -4, 4, -2, -3, -4, -4, 4, 4, 4, 4, 4, 4, -4)
################################################################################
qsort27 <- c(3, 4, 4, 4, 4, 4, 3, 4, 4, 3, 4, 4, 4, 4, 4, 4, -3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -4, 4, -3, -4, 4, 4, 4, 4, 4, 4, 4, 4, 3)
################################################################################
qsort28 <- c(-3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -4, -3, 4, -3, 4, 4, 4, 4, 4, 3, 4, 4, 3, 4, 4, -3, -3, 3, 4, 4, -4, -3, 4, 4, 4, -2, 3, 4, 4)
################################################################################
qsort29 <- c(0, 3, 4, 4, 4, 4, 4, 4, 4, 2, 4, 3, 3, -4, 2, 3, 4, 4, 4, 2, 4, 4, 4, 4, 3, 4, 3, 4, 2, -4, 3, 4, 4, 3, 3, 4, 4, 4, 4, 4, 4, -4)
################################################################################
qsort30 <- c(4, 4, 4, 2, 3, 4, 4, 4, -2, 3, 4, 4, 4, -3, 3, 4, 4, 4, 3, 4, 4, 4, 4, 3, 2, 4, 3, 3, 4, 4, 3, -1, 1, 4, 4, 0, 4, 2, -1, -2, 4, -2)
################################################################################
qsort31 <- c(2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -4, 4, 4, 4, 4, 4, -3, 4, -3, 4, 4, 4, 4, -4, 4, 4, 4, 4, 4, 4, 1, 4, 4, 4, 4, 4, 4, 4, -4)
################################################################################
qsort32 <- c(2, 3, 1, 1, 3, -1, 2, 4, 4, 2, 3, 3, 1, -1, 1, 2, 2, 4, 1, 3, 3, 2, 4, 3, 1, 3, 2, 3, 3, 4, 4, 3, -1, 2, 1, 3, 4, 4, 3, 4, 1, -3)
################################################################################
qsort33 <- c(4, 4, 3, 3, 2, 4, 2, 3, 2, 1, 4, 1, 1, -1, 0, 4, 3, 4, -4, 4, 3, 2, 4, 0, 0, 4, 3, 3, 1, 4, 4, 2, 0, -2, 4, 4, 3, 4, 4, 2, 2, -4)
################################################################################
qsort34 <- c(4, -1, 2, 4, 4, 1, 2, 4, 4, 4, 4, 4, 4, -2, 3, 4, 3, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, -1, 4, 2, -1, 3, -1, -2, 4, 4, 2, -2, 3, -2)
################################################################################
qsort35 <- c(2, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, -2, 3, 2, 3, 4, 3, 3, 4, 3, 3, 3, 3, 3, 2, 3, 3, 2, -1, -1, -1, 2, -1, 0, 2, 3, 3, 4, 2, -3)
################################################################################
qsort36 <- c(-3, 1, 0, 4, 2, 2, 3, 2, 3, 4, 3, 2, -1, -3, -1, 0, -1, 3, 1, 3, 4, 2, 4, 4, 3, 4, 2, 4, 3, -3, 2, -2, -4, 3, 0, 2, 3, 4, -1, 3, 3, 0)
################################################################################
qsort37 <- c(1, 3, 2, 1, 4, 0, 1, -2, 4, 3, 3, 1, 1, -2, 2, -1, 1, 2, 1, 2, 4, 0, 3, -1, 1, 2, -1, 4, 3, -1, 0, -1, 2, -1, 3, 2, 0, 2, -1, 2, 2, 4) 
################################################################################
qsort38 <- c(-2, 3, 1, 2, 2, 3, 2, -1, 4, 4, 3, 2, -1, -1, -3, 1, 2, 2, 1, 2, 4, 2, 4, 1, 4, 3, -1, 2, 1, -2, 3, 3, 1, -4, 4, 0, 2, 4, 3, 2, 4, -2)
################################################################################
qsort39 <-  c(-1, 3, 2, 2, 1, 3, 1, -1, 2, 4, 3, 3, -1, -1, -2, 1, 2, 1, 2, 4, 4, 2, 3, 3, 4, 4, -1, 1, 3, -3, 3, 2, -1, 1, 2, 0, 2, 4, 3, 3, 4, -4)
################################################################################
qsort40 <- c(4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, 3, 4, 4, 3, 4, -4, 4, -3, -3, 4, 3, 4, 3, 4, 4, 4, -3, 3)
################################################################################
qsort41 <- c(4, 4, -3, 4, 4, 4, 4, 4, -3, -4, 4, 4, -3, -3, -4, 4, -3, 4, -3, 4, 4, -3, 4, -3, -4, -4, -4, 4, 4, -4, 4, -4, 4, -4, 4, 4, 4, 4, -4, 4, 4, -4)
################################################################################
qsort42 <- c(2, 4, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 3, 4, -3, 4, 4, 4, 4, 4, 4, 4, 4, 4, -4, 4, 4, 4, -3, 4, 4, 4, 4, 4, 4, 4, -3)
################################################################################
qsort43 <- c(4, 3, 4, 4, 4, 4, 4, 2, 2, 4, 4, 4, 3, 3, 3, 4, 2, 2, 1, 4, 4, 4, 4, 4, 4, 4, 4, 3, 4, 3, 2, 2, 3, 4, 4, 4, 4, 4, 4, 4, 4)
################################################################################
qsort44 <- c(2, 3, 4, 4, 4, 4, 3, 3, 3, 2, 3, 3, 3, -3, -4, 3, 2, -2, -3, 3, 4, 3, -3, 3, 3, 3, 3, 4, -3, -4, 4, 4, 3, 3, 4, 3, 3, 4, 4, 4, 3, 3)
################################################################################
qsort45 <- c(4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4)
################################################################################
qsort46 <- c(2, 3, 3, 4, 3, 2, 4, 2, 4, 4, 3, 4, 3, 3, -3, 3, 2, 4, 4, 3, 3, 4, 3, 3, 4, 4, 3, 3, 3, -3, 4, 3, 4, -4, 3, 3, 4, 3, 4, 3, 4, 4)
################################################################################
qsort47 <- c(3, 4, 2, 4, 4, 4, 3, 4, 4, 1, 2, 4, 4, 3, -3, -3, -2, -2, -2, 4, 3, 3, 4, 4, -2, -3, -3, -3, 4, -3, -3, -2, -3, -4, -3, 4, 4, 4, -2, 3, 4, -2)
################################################################################
qsort48 <- c(4, 2, 2, 2, 2, -3, 4, -2, -2, 4, -1, 4, 4, -3, -1, 4, 4, 3, 3, 3, 4, 3, -1, -1, 4, 4, 3, -2, 4, 2, 3, 2, 3, -2, 3, 3, 2, 4, 2, 4, 4, -2)
################################################################################
qsort49 <- c(-4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 4, 3, 3, 4, 4, 4, 4, 4, 4, -4)
################################################################################
qsort50 <- c(2, 3, 4, 4, 2, 3, 4, 4, 3, 4, 2, 4, 4, 2, 3, 4, 2, 3, 4, 2, 4, 3, 3, 4, 3, 3, 2, 3, 2, 2, 3, 4, 2, 3, 3, 2, 2, 0, 2, 3, 3, 4)
################################################################################
qsort51 <- c(4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, -4, -3, -3, 3, 4, 3, 4, 4, 4, 4, 4, 4, 4, 4, 3, 4, 3, 3, 3, 4, -3, 4, 4, 4, 4, 4, 4, 4, -4)
################################################################################
qsort52 <- c(4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -4)
################################################################################
qsort53 <- c(-3, 3, 3, 1, 4, 4, -2, 1, -2, 3, 4, 3, 4, -4, 3, 3, 4, 4, 3, 3, 2, 3, 3, 3, 2, 2, 3, 2, 3, -1, -1, 2, 2, 2, 1, 3, 3, 3, 1, -2, 3, -3)
################################################################################
qsort54 <- c(4, 4, -3, 4, 4, 4, 4, 4, 4, 4, -2, 3, -2, 3, -2, 4, -2, -2, -2, 4, 4, -2, 4, -2, 4, -2, -2, 4, -2, -4, 4, 4, -2, 3, 3, 4, 4, 3, -2, 3, 3, 3)
################################################################################
qsort55 <- c(0, 2, 0, 3, 2, 4, 3, 3, 3, 3, 3, 3, 4, -1, 1, 3, 3, 3, 4, 3, 2, 3, 4, 3, 3, 3, 3, 3, 4, 2, 2, 3, 1, 0, 1, 4, 3, 4, 4, 2, 4, -1)
################################################################################
qsort56 <- c(3, 4, 4, 3, 4, 3, 3, -4, 4, 4, 3, 4, 3, -2, 3, 4, 4, 3, 4, 3, 4, 4, -3, 3, 4, 4, 4, 4, 4, 3, 4, 3, 4, -2, -2, 3, 3, 3, 4, 2, -2, -2)
################################################################################  
qsort57 <- c(4, 4, 3, 3, 1, 4, 1, 3, -3, 4, 3, 2, 3, -4, 2, 4, 2, 4, 4, 4, 3, 2, 3, 4, 3, 4, 4, 3, 4, 4, 4, -2, -2, 3, 4, 3, 2, 4, 4, -4, -3)
################################################################################
qsort58 <- c(4, 4, 3, 3, 1, 4, 1, 3, -3, 4, 3, 2, 3, -4, 2, 4, 2, 4, 4, 4, 3, 2, 3, 4, 3, 4, 4, 3, 4, 4, 4, -2, -2, 3, 4, 3, 2, 4, 4, -4, -3)
################################################################################
qsort59 <- c(4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 4, -4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -2, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 3, 3)
################################################################################
qsort60 <- c(3, 3, 3, 4, 3, 4, 4, 4, 2, 4, 4, 4, 3, 3, 3, 2, 3, 4, 3, 3, 4, 2, 4, 3, -4, 4, 3, 3, 4, -1, 4, 3, 3, -3, 1, 3, 4, 4, 3, 4, 4, -2)
################################################################################
qsort61 <- c(3, 3, 3, 4, 3, 4, 4, 4, 4, 3, 4, 4, 4, -2, -2, 3, 4, 4, 2, 4, 4, 3, 3, 4, -2, 4, -3, 4, 3, 3, 4, 3, 4, -3, 3, 3, 4, 4, 2, 4, 4, -4)
################################################################################
qsort62 <- c(-3, 0, 0, 3, 3, 0, 4, -4, 3, 4, 4, 2, 4, -4, 3, 1, 2, 0, -4, 3, 4, -4, -4, 2, 0, 4, 3, 0, -2, 0, 3, -3, 3, -4, 2, 2, -1, 3, -4, -2, 1, 3)
################################################################################
qsort63 <- c(4, 2, -3, 3, 4, 4, 4, 3, -3, 0, 3, 3, 2, -4, -1, 4, 4, 4, 4, -3, 4, 4, 0, 3, 3, 3, -3, 4, 4, 3, 3, -3, 0, 2, 3, 4, -1, 4, 4, 4, -3, 4)
################################################################################
qsort64 <- c(0, 0, 3, 4, 4, 3, 4, 4, 4, 4, 3, 3, 0, 0, 3, 4, 3, 4, 4, 4, 4, 4, 4, 1, 0, 4, 4, 4, 4, 0, 4, 0, 4, -3, 3, -1, 1, 4, 3, 4, 0, 0)
################################################################################
qsort65 <- c(4, 4, 4, 4, 1, 4, 4, 4, 4, 4, 4, 4, 4, -4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1, 4, 4, 4, 4, 4, 4, 4, -4, 4, 4, 4, 4, 4, 1, 4, 4)
################################################################################
qsort66 <- c(3, 4, 0, 2, 2, 2, 4, 3, 4, 4, 4, 2, -4, -3, 3, 3, 2, 3, 3, 1, 4, 4, 4, 4, -4, 4, -2, 3, 3, 1, 3, -4, 2, -1, 4, -2, 3, 4, 0, 2, -4, 3)
################################################################################
qsort67 <- c(4, 4, 4, 3, 2, 4, 3, 2, 4, 4, 2, 3, 4, -3, 4, 4, 1, 4, 4, 1, 4, 4, 3, 4, 2, 3, 2, 4, 3, 4, 3, 2, 4, -4, 3, 1, 3, 3, 4, 4, 4, -4)
################################################################################
qsort68 <- c(4, 4, 4, 3, 1, 4, 3, 2, 4, 4, 2, 4, -1, 3, 2, 1, 4, 4, 0, 4, 3, 3, 4, 2, 4, -1, 4, 4, 4, 4, 4, 2, 3, -4, 4, 4, 3, 4, 3, 3, 3, -4)
################################################################################
qsort69 <- c(1, 4, 2, 2, -2, 3, 3, -2, -2, 2, -2, 2, 3, 2, 2, 0, 3, 1, -1, 1, 3, 1, 1, -1, -4, 1, -1, 1, 2, -1, 2, -2, 3, 4, 2, 1, 1, 2, 0, 4, 2, 2)
################################################################################
qsort70 <- c(-3, -2, -2, 2, 2, 3, -1, 4, 3, 2, 4, 1, -1, 3, 2, 4, 3, 3, -2, 2, 3, 3, 4, 4, 4, 2, 2, 3, 3, 1, 1, -2, -2, -4, 4, 3, 4, -1, -4, 4, 1, -4)
################################################################################
qsort71 <- c(1, 1, 3, 3, 1, 2, 3, 4, 1, 4, 4, 4, 1, -4, 2, 1, 3, 2, 1, 1, 4, 1, 3, -1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 2, 2, 2, 2, 2, -1, 2, -1)
################################################################################
qsort72 <- c(2, 2, 3, 2, 4, 1, 4, 1, 3, 4, 3, 4, -2, -1, 1, 4, 2, 3, -1, 1, 3, 1, 3, 2, 3, 4, 2, 4, 3, 4, 2, 3, 1, 3, 2, 3, 3, 3, -1, 2, 3, 1)
################################################################################
qsort73 <- c(3, 4, 2, 4, 4, 4, 2, 4, 3, 2, 4, 3, 3, -2, 4, 3, 4, 3, 2, 3, 4, 4, 3, 3, 3, 4, 3, 4, 3, 3, 4, -3, 4, -4, 4, -3, -3, 4, 3, 4, 3, 4)
################################################################################
qsort74 <- c(2, 3, 2, 2, 3, 3, 3, 3, 4, 4, 3, 4, 4, -3, 3, 3, 3, 4, 3, 3, 4, 2, 3, 4, 3, 3, 1, 4, 2, 3, 3, 3, 2, 2, 4, 3, 4, 3, 2, 3, 4, 2)
################################################################################
qsort75 <- c(2, 4, 3, 3, 3, 4, 2, 4, 4, 4, 4, 4, 4, -4, 3, 3, 3, 3, 3, 3, 4, 3, 4, 4, 3, 3, 2, 4, 4, 2, 4, 3, 3, 3, 4, 4, 4, 4, 4, 3, 4, 4)
################################################################################
qsort76 <- c(4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 4, -2)
################################################################################
qsort77 <- c(4, 2, 3, 3, 4, 3, 4, 4, 3, 4, 4, 3, -4, 3, 3, 2, 3, 3, 3, 4, 3, 3, 4, 2, 4, 2, 3, 4, -2, 3, 4, 3, 3, 4, 3, 3, 3, 3, 3, 2, 2)
################################################################################
qsort78 <- c(4, 4, 1, 2, 3, 4, 4, 4, 4, 2, 4, 4, 4, -4, 4, 4, 4, 4, -2, 4, 4, 3, 2, 4, 4, 4, 4, 4, 4, 4, -3, 2, 4, 4, 4, 0, 3, 1, -4, 1, -4)
################################################################################
qsort79 <- c(2, -1, 3, 2, -1, 4, 2, -2, 4, 4, 3, 2, -4, 4, -2, 4, 3, 3, 1, -2, 0, 2, -4, -1, 3, 3, 4, 3, -4, -3, 1, -2, 4, 4, 4, 0, -1, -1, 3, -1, -4, -4)
################################################################################
qsort80 <- c(4, 4, 1, 3, 4, 3, 3, 4, 3, 4, 3, 3, 4, -4, 2, 4, 2, 4, 3, 4, 4, 4, 3, 4, 2, 3, 2, 4, 3, 4, 4, 4, 4, 3, 4, 2, 3, 2, 2)
################################################################################
qsort81 <- c(3, 4, 2, 3, 3, 3, 2, 3, 4, 4, 4, 4, -1, -4, 2, 4, 4, 3, 3, 4, 4, 2, 4, 4, 4, 4, 0, 4, 4, 2, 4, 4, 1, -4, 3, 4, 2, 3, 4, 4, -2, 1)
################################################################################
qsort82 <- c(4, 4, 4, 4, 3, 3, 4, 4, 4, 4, 4, 4, 2, 2, 3, 3, 2, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, -2, 4, 4, 3, -1, -4, 0, 4, 3, -4, 4, -1, -4)
################################################################################
qsort83 <- c(1, 0, 0, 1, -1, 4, 4, 3, 4, 4, 3, 4, -2, 4, 3, 2, 2, 1, 4, 0, 0, 1, 0, -2, 3, 1, 0, 1, -1, 4, 2, 2, 1, 2, -1, 1, 4, 0, -1, 1, 2)
################################################################################
qsort84 <- c(2, 4, 2, 2, 4, 4, 4, 3, 3, 4, 4, 4, 3, -4, 2, 4, 4, 2, -2, 3, 4, 2, 4, 3, 3, 3, 2, 3, 2, 3, 4, 3, 3, 2, 4, 3, 2, 3, 1, 3, 3, 4)
################################################################################
qsort85 <- c(4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, -4, -2, 4, 2, 4, 4, 4, 4, -4, 4, 4, 4, 4, 4, 3, 4, -3, 4, 4, 4, -4, 4, 4, 4, 4, 4, 4, 4, 3)
################################################################################
qsort86 <- c(1, 2, 4, -1, 4, 2, 4, 4, 2, 4, 4, 4, -1, -3, 3, 4, 4, 3, 3, 3, 4, 1, 3, 3, 3, 4, 3, 4, 4, 3, 3, 2, -1, 4, 3, 4, 4, 2, 3, 1, 4, 2)
################################################################################
qsort87 <- c(3, 3, -2, -2, -1, 1, 3, 3, 1, 4, 4, 3, 3, -2, 3, 3, -1, 3, 3, -1, 1, -1, 2, 4, 2, 3, 2, 3, 3, 1, 4, 1, 4, 0, -1, -1, 2, 3, -1, -1, 2, -2)
################################################################################
qsort88 <- c(3, 4, 3, 3, 4, 3, 3, 4, 3, 4, 4, 4, 4, -4, 4, 4, 3, 4, 3, 2, 3, 3, -3, 3, 4, 3, -3, -4, 3, 4, 4, 4, 4, 4, -1, 4, 4, 4, 3, 4, 3, 4)
################################################################################
qsort89 <- c(1, 4, 3, 4, 0, 3, -1, 4, 4, 4, 3, 4, 4, -3, -2, -1, 1, 1, 2, 2, 3, 1, 2, 3, -1, 4, 4, 3, 4, -1, 4, -1, 1, -4, -4, 0, -3, -4, -1, -2, 2, -4)
################################################################################
qsort90 <- c(2, 4, 4, 3, 2, 4, 4, 4, 4, 3, 4, 4, 3, -4, -1, 4, 2, 4, 4, 2, 4, -4, 3, 4, 4, 4, 4, 2, 3, -3, 3, 4, 3, 2, 4, 4, 0, 4, 1, 4, 2, 4)
################################################################################
qsort91 <- c(2, 4, 4, 4, 3, 4, 3, 3, -2, 3, 4, 2, 3, -4, 4, 4, 4, 4, 4, 2, 4, -1, 4, 4, 3, 4, 4, 2, 2, 4, 2, 2, 4, -3, 1, 4, 3, 4, 2, 4, 3, 4)
################################################################################
qsort92 <- c(-4, 1, 2, -3, 2, -2, 2, 2, -2, 2, 2, 2, -2, 1, 2, 1, -2, -1, -1, -1, -1, -1, -2, -1, -1, -1, -1, -1, -2, -2, -2, -2, -2, -2, -2, -1, -1, 2, -4, 4, 4, 2)
################################################################################
qsort93 <- c(4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -3, 4, 4, 4, -4, 4, 4, 4, 4, 4, 4, 4, 4)
################################################################################
qsort94 <- c(4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -4, -2, 4, 4, 4, 4, 3, 4, -4, 4, 4, 4, 4, 4, 4, 4, -2, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4)
################################################################################
qsort95 <- c(4, 3, 2, 4, 4, 4, 1, 3, 4, 4, 2, 3, -3, -2, 4, 3, 4, 3, 3, 4, -4, 4, 4, 4, 3, 4, 3, 4, -3, 4, -2, 4, 4, -1, 4, 0, 3, 4, 3, -3, 4)
################################################################################
qsort96 <- c(1, 4, 4, 2, 0, 1, 1, 2, 4, 4, 1, 3, 2, -2, -2, -2, 1, 2, 2, 2, 2, 1, 2, 3, 3, 4, 4, 3, 4, -2, 4, -1, 1, -4, -4, -4, -2, 1, -1, -3, 2, -3)
################################################################################
qsort97 <- c(4, 4, 0, 0, 1, 4, 3, 4, 4, 3, 4, 2, 3, -3, 4, 4, 3, 4, 3, 1, 1, -4, 2, 2, 4, 3, -1, 1, -2, -1, 3, 4, 4, 2, 4, 4, 2, 4, 1, 0, 2, 1)
################################################################################
qsort98 <- c(4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -4, 2, -4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4)
################################################################################
qsort99 <- c(3, 4, 3, 4, 4, 4, 2, 2, 2, 4, 3, 3, 4, 2, 3, 1, 4, 3, 3, -3, 4, 4, 4, 2, -4, -4, -3, -3, -3, -3, -3, -3, -2, -2, -3, -4, -4, -2, -3, -3, -3, -4)
################################################################################
qsort100 <- c(4, 4, -3, -1, 3, 3, 3, 3, 4, 4, 4, -2, 3, -4, -4, 4, 4, 4, 4, 2, 4, 3, 3, -1, 2, 4, 1, 4, 2, 2, 3, -3, -1, 4, -2, -3, 3, 4, 4, 4, 3, -1)
################################################################################
qsort101 <- c(3, 4, 4, 2, 3, 4, 3, 4, 3, 4, 4, 3, 4, -1, -1, 4, 3, 4, 4, 4, 3, -2, 4, 4, 4, 4, 3, 4, 4, -2, 4, 4, -1, -2, 3, 4, 4, 4, 3, 4, -3, 4)
################################################################################
qsort102 <- c(-2, 1, 1, 2, 1, 1, 1, 1, -1, 0, 3, 0, -1, 1, -3, 3, 0, 2, 0, -2, 0, -2, 2, -1, 2, 4, 0, 3, 1, -1, 2, -1, -1, -1, 2, 3, 2, -1, 2, 1, 4, -2)
################################################################################
qsort103 <- c(4, 4, 2, 2, 1, 4, 4, 4, 4, 4, 4, 4, 2, -1, -1, -1, -1, 1, 2, 2, 1, -1, -1, -1, 1, 2, -1, 3, 2, 4, 2, -1, -2, 4, 3, 1, 2, 2, 2, -2, -1, 3)
################################################################################

#===============================================================================
mydata <- cbind(qsort1,qsort2,qsort3,qsort4,qsort5,qsort6,qsort7,qsort8,qsort9,qsort10,qsort11,qsort12,qsort13,qsort14,qsort15,qsort16,qsort17,qsort18,qsort19, qsort20,qsort21,qsort22,qsort23,qsort24,qsort25,qsort26,qsort27,qsort28,qsort29, qsort30,qsort31,qsort32,qsort33,qsort34,qsort35,qsort36,qsort37,qsort38,qsort39, qsort40,qsort41,qsort42,qsort43,qsort44,qsort45,qsort46,qsort47,qsort48,qsort49,qsort50,qsort51,qsort52,qsort53,qsort54,qsort55,qsort56,qsort57,qsort58,qsort59,qsort60,qsort61,qsort62,qsort63,qsort64,qsort65,qsort66,qsort67,qsort68,qsort69,qsort70,qsort71,qsort72,qsort73,qsort74,qsort75,qsort76,qsort77,qsort78,qsort79,qsort80,qsort81,qsort82,qsort83,qsort84,qsort85,qsort86,qsort87,qsort88,qsort89, qsort90,qsort91,qsort92,qsort93,qsort94,qsort95,qsort96,qsort97,qsort98,qsort99, qsort100,qsort101,qsort102,qsort103)
#===============================================================================

#===============================================================================
# Dimensão da Matriz
dim(mydata)
#===============================================================================

#===============================================================================
# Explore as correlações entre Q-sorts
cor(mydata, 
    method = "pearson")
#===============================================================================

#===============================================================================
# Análise Fatorial Q
result <- qmethod(mydata,
                  nfactors = 12,
                  extraction = "PCA",
                  rotation = "varimax", 
                  forced = FALSE,
                  distribution = c(1:nrow(mydata)),
                  cor.method = "pearson",
                  silent = FALSE)
#===============================================================================

#===============================================================================
# características gerais/Pontuações fatoriais
summary(result)
#===============================================================================

#===============================================================================
# Geral
result$f_char$characteristics

# Autovalores
result$f_char$characteristics$eigenvals

# % de variabilidade Explicada
result$f_char$characteristics$expl_var

# Nº Q-sorts carregando significativamente
result$f_char$characteristics$nload

# Nº de Declarações (statment)
result$brief$nstat

# Nº de Participantes
result$brief$nqsorts

# 
format(result$qdc, digits = 1, nsmall=2)


# Carga Fatoriais/Participantes
round(result$loa, digits = 2)

# Q-sorts sinalizados: indicam TRUE
result$flag
round(result$flag)
#===============================================================================

#===============================================================================
# Carga Fatoriais Indicação Flags
loa.and.flags(result)
#===============================================================================

#===============================================================================
# Gráfico de Declividade
screeplot(prcomp(mydata),
          main = "ScreePlot dos Fatores",
          type = "lines", # "barplot"
          col = "blue", 
          pch = 16,
          lwd = 3,
          )
title(xlab = "Nº de Fatores")
#title(ylab = "Variância Explicada")
#===============================================================================


#===============================================================================
# Resumo: características gerais e pontuações fatoriais
summary(result)
#===============================================================================


#===============================================================================
# Trace os escores z para Declarações

# As declarações são classificadas: 
# Do Maior Consenso (parte inferior) ao Maior Desacordo (topo).

plot(result,
     xlim = c(-3.5, 3.5),
     cex = 0.6,
     cex.axis=0.8,
     cex.main = 2,
     leg.pos = "bottomright", #topleft
     cex.leg = 0.5,
     main = "Declarações(Conseso e Distintiva) e Fatores ",
     lty = 2,
     lwd = 5
     )

legend("topright", 
       legend = c("Eigenvalues"), 
       col = "blue", 
       pch = 16, 
       bty = "n")
#===============================================================================





#===============================================================================
# Reordene as afirmações das pontuações mais altas para as mais baixas para cada fator
scores <- cbind(round(result$zsc, digits=2), result$zsc_n)
nfactors <- ncol(result$zsc)
col.order <- as.vector(rbind(1:nfactors, (1:nfactors)+nfactors))
scores <- scores[col.order]
scores

# Order the table from highest to lowest z-scores for factor 1
scores[order(scores$zsc_f1, decreasing = T), ]
# (to order according to other factors, replace 'f1' for 'f2' etc.)
#===============================================================================


#===============================================================================
# Declarações Distintivas/Consenso
#Geral
result$qdc

# Declarações de Consenso
result$qdc[which(result$qdc$dist.and.cons == "Consensus"), ]


# Declarações que distinguem todos os fatores
result$qdc[which(result$qdc$dist.and.cons == "Distinguishes all"), ]

#===============================================================================